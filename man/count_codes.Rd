% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/count_codes.R
\name{count_codes}
\alias{count_codes}
\title{Count codes by preferred coder and transcript}
\usage{
count_codes(
  excerpts,
  preferred_coders,
  output_type = c("tibble", "kable", "datatable"),
  include_zero = FALSE
)
}
\arguments{
\item{excerpts}{A data frame containing at least \code{media_title},
\code{excerpt_creator}, and one or more numeric/binary columns whose names
start with \code{"c_"} (0/1 recommended).}

\item{preferred_coders}{Character vector of coder names, ordered from most-
to least-preferred. Used to select which coder's excerpts are retained per
transcript (\code{media_title}).}

\item{output_type}{One of \code{"tibble"}, \code{"kable"}, or
\code{"datatable"}; controls the return type. Default is \code{"tibble"}.}

\item{include_zero}{Logical; if \code{TRUE}, keep codes with zero total
applications. Default \code{FALSE}.}
}
\value{
If \code{output_type = "tibble"}, a tibble with columns:
\itemize{
\item \code{Code}: the code variable name (a \code{c_*} column).
\item \code{total_preferred_coder}: total number of applications (sum of 1s).
\item \code{transcript_count}: number of transcripts with at least one 1.
\item \code{transcript_proportion}: proportion of transcripts with at least one 1
(0â€“1, rounded to 2 decimals).
}
If \code{"kable"}, a \code{knitr_kable} object; if \code{"datatable"}, a
\code{DT::datatable} widget.
}
\description{
Summarizes binary \code{c_*} code columns after restricting each transcript
to a single preferred coder. Returns per-code totals across excerpts and,
per code, the number and proportion of transcripts in which the code appears
at least once.
}
\details{
For each transcript (\code{media_title}), the function keeps \emph{all}
excerpts from the most-preferred coder present in \code{preferred_coders}
and drops rows by other coders. It then:
\enumerate{
\item Computes \code{total_preferred_coder}: the sum of 1s for each code
across the retained excerpts.
\item Computes \code{transcript_count}: the number of distinct transcripts
in which a code appears at least once, and \code{transcript_proportion}:
that count divided by the number of transcripts retained after filtering.
}

Uses dplyr's \code{.by} argument (requires dplyr >= 1.1.0). If you need
compatibility with older dplyr versions, replace that step with an explicit
\code{group_by(media_title)} + \code{filter()}.
}
\examples{
set.seed(1)
toy <- data.frame(
  media_title     = rep(paste0("T", 1:3), each = 4),
  excerpt_creator = rep(c("Ann","Bob","Ann","Cara"), 3),
  c_help          = rbinom(12, 1, .4),
  c_harm          = rbinom(12, 1, .2),
  stringsAsFactors = FALSE
)
# Prefer Ann over Bob over Cara
count_codes(toy, preferred_coders = c("Ann","Bob","Cara"))

# Keep zero-count codes
count_codes(toy, c("Ann","Bob","Cara"), include_zero = TRUE)

# Return a knitr::kable table
count_codes(toy, c("Ann","Bob","Cara"), output_type = "kable")

}
