% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/clean_data.R
\name{clean_data}
\alias{clean_data}
\title{Clean and standardize coded qualitative excerpts}
\usage{
clean_data(excerpts, preferred_coders, rename_vars = NULL, relabel_vars = NULL)
}
\arguments{
\item{excerpts}{A data frame containing coded excerpts (e.g., exported from Dedoose).}

\item{preferred_coders}{A character vector listing coders in order of preference (e.g.,
\code{c("coder1", "coder2")}). Used to select the preferred version of each excerpt.}

\item{rename_vars}{Optional named list or vector of variables to rename, in the format
\code{c(oldname = "newname")}.}

\item{relabel_vars}{Optional named list of new variable labels, in the format
\code{list(varname = "new label")}.}
}
\value{
A list with two elements:
\describe{
\item{data}{The cleaned and filtered excerpt dataset.}
\item{codebook}{A data frame listing variable names, labels, and data types.}
}
}
\description{
Cleans, standardizes, and labels a dataset of coded qualitative excerpts
(e.g., exported from Dedoose or a similar platform). The function performs
the following key operations:
\enumerate{
\item Standardizes column names to lowercase and replaces spaces with underscores.
\item Renames \code{excerpt_copy} to \code{excerpt} if present.
\item Removes columns ending with "range" or "weight".
\item Converts all code columns (those starting with "code" and ending with "applied")
into logical (\code{TRUE}/\code{FALSE}) variables.
\item Cleans and renames code variables using a \code{c_} prefix.
\item Filters the dataset to retain excerpts from a preferred coder (based on rank order).
\item Adds descriptive variable labels using the \code{labelled} package.
\item Optionally renames or relabels variables.
\item Removes columns that are entirely \code{NA}.
\item Generates a codebook summarizing variable names, labels, and types.
}
}
\details{
The function standardizes and cleans a coded excerpt dataset while preserving
coder priority and metadata. It returns both the cleaned dataset and its
associated codebook for easy reference or export.
}
\examples{
# Example data frame
excerpts <- data.frame(
  media_title = c("Transcript 1", "Transcript 1", "Transcript 2"),
  excerpt_creator = c("alice", "bob", "alice"),
  excerpt_copy = c("It was a good day.", "It was a good day.", "We learned a lot."),
  code_emotion_applied = c("TRUE", "FALSE", "TRUE"),
  code_learning_applied = c("FALSE", "TRUE", "TRUE"),
  weight = c(1, 2, 3)
)

# Preferred coders (in order)
preferred_coders <- c("alice", "bob")

# Run cleaning function
result <- clean_data(
  excerpts = excerpts,
  preferred_coders = preferred_coders,
  relabel_vars = list(c_emotion = "Emotion expressed", c_learning = "Learning mentioned")
)

# Extract cleaned data and codebook
cleaned_excerpts <- result$data
codebook <- result$codebook

# View results
head(cleaned_excerpts)
head(codebook)

}
