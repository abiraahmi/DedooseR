% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/clean_data.R
\name{clean_data}
\alias{clean_data}
\title{Clean and prepare Dedoose excerpt data}
\usage{
clean_data(excerpts, preferred_coders)
}
\arguments{
\item{excerpts}{A data frame of excerpts or a file path (character string) to
an Excel file exported from Dedoose.}

\item{preferred_coders}{A character vector giving the coders in order of
preference. Excerpts will be filtered so that, for each media title,
only excerpts from the highest-ranked coder are retained.}
}
\value{
A cleaned \code{data.frame} containing excerpts and associated
variables.
}
\description{
This function takes excerpt data exported from Dedoose (either as a data frame
or as a file path to an Excel file) and prepares it for analysis by:
\itemize{
\item Standardizing variable names to lowercase
\item Renaming \code{"excerpt copy"} to \code{"excerpt"}
\item Dropping columns ending with \code{"range"} or \code{"weight"}
\item Converting code columns (prefixed with \code{"code: "}) to logical variables
\item Renaming code columns to remove prefixes/suffixes
\item Filtering excerpts to retain only the coder with the highest preference
\item Adding variable labels for interpretability
}
}
\details{
In addition to returning a cleaned data frame, the function creates a
\code{codebook} object in the global environment that contains metadata on all
variables in the dataset, including variable names, labels, and types.

The function also creates a \code{codebook} object in the global environment
with three columns:
\itemize{
\item \code{variable}: the variable name
\item \code{label}: the variable label (if assigned, otherwise the name)
\item \code{type}: the storage type/class of the variable
}
}
\examples{
\dontrun{
# Example usage
excerpts <- readxl::read_xlsx("inst/raw_data/test_data_manipulated.xlsx")
preferred_coders <- c("s", "r", "l", "a")
cleaned <- clean_data(excerpts, preferred_coders)

# View codebook
head(codebook)
}

}
