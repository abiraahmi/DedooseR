% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/clean_data.R
\name{clean_data}
\alias{clean_data}
\title{Clean and Prepare Excerpts Data from Excel File}
\usage{
clean_data(filepath, preferred_coders)
}
\arguments{
\item{filepath}{A character string giving the path to the Excel file to read.}

\item{preferred_coders}{A character vector listing coders in order of preference.
The function keeps excerpts only from the highest-ranked coder per \verb{Media Title}.}
}
\value{
A cleaned tibble/data frame containing filtered excerpts with logical code columns
and only preferred coders per media title.
}
\description{
This function reads an Excel file containing excerpt data, cleans and processes it by:
\itemize{
\item Reading all columns as text to avoid type guessing issues,
\item Dropping columns whose names end with "Range" or "Weight",
\item Converting code columns (those starting with "Code: ") from text to logical,
interpreting "true" (case insensitive) as TRUE, otherwise FALSE,
\item Renaming code columns by removing the prefix "Code: " and suffix " Applied",
\item Filtering the data to keep only one preferred coder per \verb{Media Title} based on the provided order.
}
}
\details{
The function expects columns starting with "Code: " to contain textual "true"/"false" values,
which are converted to logical TRUE/FALSE. Columns ending with "Range" or "Weight" are removed.
Excerpts are filtered so that for each \verb{Media Title}, only the coder highest in the
\code{preferred_coders} vector is retained.
}
\examples{
\dontrun{
preferred <- c("Coder1", "Coder2", "Coder3")
cleaned_data <- clean_data("path/to/excerpts.xlsx", preferred)
}

}
