% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/create_code_summary.R
\name{create_code_summary}
\alias{create_code_summary}
\title{Create a Summary Table and Optional Plot of Coded Excerpts}
\usage{
create_code_summary(
  excerpts,
  table_min_count = 1,
  table_min_prop = NULL,
  plot = FALSE,
  plot_min_count = NULL,
  plot_min_prop = NULL,
  output_type = c("tibble", "kable", "datatable"),
  exclude = NULL,
  plot_metric = c("count", "prop", "both"),
  fill_color = "steelblue"
)
}
\arguments{
\item{excerpts}{A data frame containing a column named \code{media_title} and one or more
logical (TRUE/FALSE) columns indicating the presence of each code. Each code variable
may have a \code{label} attribute (e.g., from \code{haven::read_sav()}) used for display instead
of the variable name.}

\item{table_min_count}{Minimum number of occurrences required for a code to appear
in the summary table. Defaults to \code{1}.}

\item{table_min_prop}{Optional numeric between 0 and 1 indicating the minimum proportion
(relative to the most frequent code) required for inclusion in the table.}

\item{plot}{Logical; whether to generate a ggplot2 bar chart summarizing code frequencies.
Defaults to \code{FALSE}.}

\item{plot_min_count}{Minimum count threshold for including codes in the plot.
If \code{NULL}, defaults to the same as \code{table_min_count}.}

\item{plot_min_prop}{Optional numeric between 0 and 1 indicating the minimum proportion
(relative to the maximum count) required for inclusion in the plot. If \code{NULL}, defaults
to the same as \code{table_min_prop}.}

\item{output_type}{Character string specifying the output format for the summary table.
One of \code{"tibble"} (default), \code{"kable"}, or \code{"datatable"}.}

\item{exclude}{Optional character vector of code variable names to exclude from the summary.}

\item{plot_metric}{Character string specifying what the plot should display:
\code{"count"} (absolute frequencies), \code{"prop"} (proportion of media titles covered),
or \code{"both"} (dual-axis plot showing both). Defaults to \code{"count"}.}

\item{fill_color}{Character string specifying the fill color for the bars in the plot.
Defaults to \code{"steelblue"}.}
}
\value{
\itemize{
\item If \code{plot = FALSE}: the formatted table in the format specified by \code{output_type}
(tibble, kable, or datatable).
\item If \code{plot = TRUE}: an invisible list with two elements:
\describe{
\item{table}{The formatted summary table.}
\item{plot}{A \code{ggplot2} object showing code frequencies.}
}
}
}
\description{
Summarizes the frequency and coverage of logical (code) variables across a set of
media excerpts, using variable labels (from \code{haven}) as display names when available.
Optionally produces a bar plot showing counts, proportions, or both.
}
\details{
Logical variables in \code{excerpts} are interpreted as binary indicators of whether each
code applies to a given media item. The function counts the number of excerpts per code
and computes the number and proportion of unique \code{media_title} values represented.
Variable labels (if present via \code{attr(x, "label")}) are used for display instead of
raw variable names.

The resulting table can be returned as a tibble, formatted with \code{knitr::kable()},
or displayed as an interactive \code{DT::datatable()}. If \code{plot = TRUE}, both the table
and a ggplot object are returned invisibly as a list.
}
\examples{
\dontrun{
library(haven)
library(dplyr)

# Example data frame with haven-style labels
df <- tibble::tibble(
  media_title = c("A", "B", "C", "D"),
  code_01 = c(TRUE, FALSE, TRUE, TRUE),
  code_02 = c(FALSE, TRUE, TRUE, FALSE)
)
attr(df$code_01, "label") <- "Empathy"
attr(df$code_02, "label") <- "Resilience"

create_code_summary(df, plot = TRUE, output_type = "kable")
}

}
