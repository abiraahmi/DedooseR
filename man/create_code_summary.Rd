% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/create_code_summary.R
\name{create_code_summary}
\alias{create_code_summary}
\title{Create a Code Frequency Summary and Optional Plot}
\usage{
create_code_summary(
  excerpts,
  table_min_count = 1,
  table_min_prop = NULL,
  plot = FALSE,
  plot_min_count = NULL,
  plot_min_prop = NULL,
  output_type = c("tibble", "kable", "datatable"),
  exclude = NULL,
  plot_metric = c("count", "prop", "both"),
  fill_color = "steelblue"
)
}
\arguments{
\item{excerpts}{A data frame containing at least a \code{media_title} column and one or more logical columns
representing coded excerpts (e.g., \code{c_help}, \code{c_stigma}).}

\item{table_min_count}{Minimum number of excerpts required for a code to be included in the summary table.
Defaults to \code{1}.}

\item{table_min_prop}{Optional numeric threshold (0–1) specifying the minimum proportion of the
most frequent code required for inclusion in the summary table.}

\item{plot}{Logical. If \code{TRUE}, generates a bar plot of code frequencies.
Defaults to \code{FALSE}.}

\item{plot_min_count}{Minimum number of excerpts required for a code to be included in the plot.
If \code{NULL}, defaults to \code{table_min_count}.}

\item{plot_min_prop}{Optional numeric threshold (0–1) specifying the minimum proportion
of the maximum frequency required for inclusion in the plot.
If \code{NULL}, defaults to \code{table_min_prop}.}

\item{output_type}{Type of output for the summary table: one of \code{"tibble"}, \code{"kable"}, or \code{"datatable"}.
Defaults to \code{"tibble"}.}

\item{exclude}{Optional character vector of code variable names to exclude from the summary.}

\item{plot_metric}{Character string specifying which metric to plot:
\itemize{
\item \code{"count"} – excerpt frequencies,
\item \code{"prop"} – proportions of unique media titles, or
\item \code{"both"} – dual-axis plot with counts (bottom) and proportions (top).
Defaults to \code{"count"}.
}}

\item{fill_color}{Character string specifying the fill color for bars in the plot.
Defaults to \code{"steelblue"}.}
}
\value{
If \code{plot = FALSE}, returns a summary table as a tibble, \code{knitr::kable}, or \code{DT::datatable}
depending on \code{output_type}.
If \code{plot = TRUE}, returns a list with two elements:
\describe{
\item{\code{table}}{A tibble of summarized code counts and proportions.}
\item{\code{plot}}{A \code{ggplot2} object showing the frequency and/or proportion of codes.}
}
}
\description{
Summarizes the frequency and coverage of logical code variables in a dataset of excerpts.
The function produces a summary table (as a tibble, \code{knitr::kable}, or \code{DT::datatable})
and, optionally, a bar plot showing code frequencies or proportions.
}
\details{
Logical columns in \code{excerpts} are treated as binary code indicators.
Variable labels (if defined via \code{attr(x, "label")}) are used as code names in the output.
}
\examples{
# Example dataset
df <- data.frame(
  media_title = rep(paste0("Transcript_", 1:5), each = 3),
  c_help = sample(c(TRUE, FALSE), 15, replace = TRUE),
  c_stigma = sample(c(TRUE, FALSE), 15, replace = TRUE),
  c_hope = sample(c(TRUE, FALSE), 15, replace = TRUE)
)

# Add variable labels
attr(df$c_help, "label") <- "Help-Seeking"
attr(df$c_stigma, "label") <- "Stigma"
attr(df$c_hope, "label") <- "Hope"

# Summarize codes (tibble output)
create_code_summary(df, table_min_count = 2)

# Display as formatted table
create_code_summary(df, table_min_count = 2, output_type = "kable")

# Plot excerpt frequencies
create_code_summary(df, table_min_count = 1, plot = TRUE, plot_metric = "count")

# Plot proportions of media titles
create_code_summary(df, table_min_count = 1, plot = TRUE, plot_metric = "prop")

# Plot both frequency and proportion on dual axes
create_code_summary(df, table_min_count = 1, plot = TRUE, plot_metric = "both")

}
